<!-- 继承Index/index里的内容 -->
<extend name="Index/index" />

<block name="title">
    <title>新闻添加</title>
</block>
<block name="content">
    <!-- SAMPLE BOX CONFIGURATION MODAL FORM-->
    <div class="modal fade" id="box-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title">Box Settings</h4>
            </div>
            <div class="modal-body">
              Here goes box setting content.
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Save changes</button>
            </div>
          </div>
        </div>
    </div>
    <!-- /SAMPLE BOX CONFIGURATION MODAL FORM-->
    <div class="container">
        <div class="row">
            <block name = 'content'>
            <div id="content" class="col-lg-12">
                <!-- PAGE HEADER-->
                <div class="row">
                    <div class="col-sm-12">
                        <div class="page-header" style="min-height:45px;">
                            <!-- STYLER -->
                            
                            <!-- /STYLER -->
                            <!-- BREADCRUMBS -->
                            <ul class="breadcrumb">
                                <li>
                                    <i class="fa fa-home"></i>
                                    <a href="index.html">轮播图管理</a>
                                </li>
                                <li>添加轮播图片</li>
                            </ul>
                            <!-- /BREADCRUMBS -->
                        </div>
                    </div>
                </div>
                <!-- /PAGE HEADER -->
                <!-- DASHBOARD CONTENT -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="box border inverse">
                                    <div class="box-title">
                                        <h4><i class="fa fa-bars"></i>轮播图内容管理</h4>
                                        <div class="tools">
                                            
                                        </div>
                                    </div>
                                    <div class="box-body">
                                        <form id="add" action="{:U('Admin/Slide/update')}" class="form-horizontal form-bordered"  method="post" enctype="multipart/form-data">
                                            <div class="panel-body panel-form">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-2 col-sm-2" for="fullname">相关标题：</label>
                                                        <div class="col-md-8 col-sm-8">
                                                            <input class="form-control" type="text"  name="title" id="name" placeholder='相关标题' value="{$slide['title']}" disabled>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="control-label col-md-2 col-sm-2">类型：</label>
                                                        <div class="col-md-3 col-sm-3">
                                                            <select class="form-control" name="type" id="type" disabled>
                                                                <option value="">请选择</option>
                                                                <option <if condition="$slide.type eq 1"> selected="selected"</if> value="1">国际赛事轮播图</option>
                                                                <option <if condition="$slide.type eq 2"> selected="selected"</if> value="2">国内赛事轮播图</option>
                                                                <option <if condition="$slide.type eq 3"> selected="selected"</if> value="3">首页顶部轮播图</option>
                                                                <option <if condition="$slide.type eq 4"> selected="selected"</if> value="4">首页中部轮播图</option>
                                                                <option <if condition="$slide.type eq 5"> selected="selected"</if> value="5">首页底部轮播图</option>   
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">上传图片：</label>
                                                        
                                                        <div class="col-md-4">
                                                            <img src="" alt="" id="cover_box" style="display:none">
                                                            <a id="upload">
                                                                <img src="{$slide['img']}" width="250px" alt="" id="cover_prev">
                                                            </a>
                                                        </div>

                                                        
                                                    </div>
                                                    
                                                    <div class="form-group">
                                                        <label class="control-label col-md-2 col-sm-2" for="fullname">链接地址：</label>
                                                        <div class="col-md-8 col-sm-8">
                                                            <input class="form-control" type="text"  name="link_url" id="link_url" placeholder='点击图片后将要跳转的地址(非必填项)' value="{$slide['link_url']}" disabled>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">是否显示：</label> 
                                                        <div class="col-md-8"> 
                                                            <label class="radio-inline"> <input type="radio" disabled class="uniform" name="is_online" <if condition="$slide.is_online eq 1"> checked="checked"</if> value="1"> 是 </label> 
                                                            <label class="radio-inline"> <input type="radio" disabled class="uniform" name="is_online" <if condition="$slide.is_online eq 2"> checked="checked"</if> value="2"> 否 </label>
                                                        </div>
                                                     </div>
                                                    <input type="hidden" name="slide_id" value="{$slide['id']}">
                                                   

                                                </div>
                                                
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
               <!-- /DASHBOARD CONTENT -->
              
                <!-- /CALENDAR & CHAT -->
                <div class="footer-tools">
                    <span class="go-top">
                        <i class="fa fa-chevron-up"></i> Top
                    </span>
                </div>
                
            </div><!-- /CONTENT-->
        </div>
    </div>
   
</block>
<block name="js">
    <script type="text/javascript" src="__PUBLIC__/Admin/js/ueditor/ueditor.config.js"></script>
    <script type="text/javascript" src="__PUBLIC__/Admin/js/ueditor/ueditor.all.js"></script>
    <!--<script src="/static/admin/js/news/add.js"></script>-->
    <script>
        var default_img = $('#upload').find('img').attr('src');

        //图片上传
        $('#upload').click(function() {
            $('input[name=img]').click();
        });

        $('#cancel').click(function() {
            $('#upload').find('img').attr('src', default_img);
            $('input[name=img]').val('');
        });

        // 头像文件验证
        $('#img').change(function() {
            var file = $(this)[0].files[0];
            //验证文件大小
            var size = file.size;
            var max_size = 1000000;
            if (size > max_size) {
                alert('文件过大，请重新选择！');
                $(this).val('');
                return false;
            }
            //验证文件类型
            var mime = file.type;
            var allow_type = ['image/jpeg', 'image/gif', 'image/png', 'image/bmp'];
            if (allow_type.indexOf(mime) == -1) {
                alert('文件类型有误，请选图片文件！');
                $(this).val('');
                return false;
            }

            var reader = new FileReader();
            reader.readAsDataURL(file);
            console.log(reader);
            reader.onload = function(){
                $('#cover_box').attr('src', reader.result);
                $('#cover_box')[0].onload = function() {
                    $('#cover_prev').attr('src', reader.result);
                }
            }
        });

        //编辑器
        var ue = UE.getEditor('container',{
            initialFrameHeight: 600,
        });

        var demo=$("#add").Validform({
            tiptype:3,
            label:".control-label",
            showAllError:true,
            datatype:{
                "zh1-6":/^[\u4E00-\u9FA5\uf900-\ufa2d]{1,6}$/
            },
        
        });
    
    //通过$.Tipmsg扩展默认提示信息;
    //$.Tipmsg.w["zh1-6"]="请输入1到6个中文字符！";
    demo.tipmsg.w["zh1-6"]="请输入1到6个中文字符！";
    
    demo.addRule([{
        ele:".form-control:eq(0)",
        datatype:"*"
    },
    {
        ele:"#type",
        datatype:"*",
        nullmsg:"请选择类型"
    }]);
    </script>
</block>